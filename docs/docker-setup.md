# ğŸ³ ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ï¼ˆlocal-dev-setup.mdï¼‰

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¨é¡ä¼¼ã®ç’°å¢ƒã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å†ç¾ã—ã€æ¤œè¨¼ã‚„é–‹ç™ºã‚’åŠ¹ç‡åŒ–ã™ã‚‹ãŸã‚ã« Docker ãƒ™ãƒ¼ã‚¹ã®ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚

---

## âœ… èµ·å‹•ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ï¼ˆdocker-composeï¼‰

| ã‚µãƒ¼ãƒ“ã‚¹å           | ç›®çš„                                      |
| --------------- | --------------------------------------- |
| Azurite         | Azure Blob Storage ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼         |
| Cosmos Emulator | Azure Cosmos DB ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼            |
| SWA CLI         | Static Web Apps ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ï¼ˆBlazor WASMç­‰ï¼‰ |

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆä¾‹

```
/docker-compose.yml
/docker/
  â”œâ”€â”€ cosmos/         # Cosmos Emulator è¨­å®š
  â””â”€â”€ azurite/        # Azurite è¨­å®šï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
```

---

## ğŸš€ èµ·å‹•æ‰‹é †

```bash
docker-compose up -d
```

> ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ï¼š
>
> * Cosmos Emulator: [http://localhost:8081/\_explorer/index.html](http://localhost:8081/_explorer/index.html)
> * Azurite Blob: [http://127.0.0.1:10000/devstoreaccount1](http://127.0.0.1:10000/devstoreaccount1)

---

## ğŸ” BackupService ã®æ¤œè¨¼ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ã®å‹•ä½œæ¤œè¨¼ã®ãŸã‚ã€API ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã« `/api/echo` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

### ğŸ“Œ `/api/echo` ã®ä»•æ§˜

* ãƒ¡ã‚½ãƒƒãƒ‰: `POST`
* å…¥åŠ›: ä»»æ„ã® JSON ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰
* å‡ºåŠ›: åŒã˜ JSON ã‚’ `200 OK` ã§è¿”ã™

### âœ… ä½¿ã„æ–¹ï¼ˆcurl ä¾‹ï¼‰

```bash
curl -X POST http://localhost:7071/api/echo \
     -H "Content-Type: application/json" \
     -d '{"message":"ping"}'
```

### ğŸ¯ ä½¿ç”¨ç›®çš„

* ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã€œFunctions API é–“ã®ç–é€šç¢ºèª
* CI ã§ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ Snapshot ãƒ†ã‚¹ãƒˆå¯¾è±¡

---

## ğŸ”§ è£œè¶³

* Cosmos Emulator ã®æ¥ç¶šã«ã¯ `AccountEndpoint=https://localhost:8081/;AccountKey=...` ã‚’ä½¿ç”¨
* Blazor WASM ã‹ã‚‰ã®æ¥ç¶šå…ˆã‚’ `http://localhost:7071/api/` ã«è¨­å®šã™ã‚‹ã¨ã€SWA CLIã¨é€£æºå¯èƒ½

---

## ğŸ”’ Key Vault ã®æ‰±ã„ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰

Azure Key Vault ã«ã¯å…¬å¼ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãã®ãŸã‚ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã¯æ¬¡ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§ **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ç–‘ä¼¼ç½®æ›** ã—ã¾ã™ã€‚

| ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ                                      | ä½¿ã„æ–¹                                                                                | é©åˆ‡ãªã‚±ãƒ¼ã‚¹                       |
| ------------------------------------------ | ---------------------------------------------------------------------------------- | ---------------------------- |
| **.env / userâ€‘secrets**                    | `Directory.Build.props` ã§ `UserSecretsId` ã‚’è¨­å®šã—ã€`dotnet user-secrets set KEY VALUE` | C# ã‚³ãƒ¼ãƒ‰ãŒç›´æ¥ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã€‚    |
| **`local.settings.json`**                  | Functions ã®ãƒ­ãƒ¼ã‚«ãƒ«è¨­å®šï¼ˆ`Values` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ã«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’è¨˜è¼‰                                        | Functions ã ã‘ãŒã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’å¿…è¦ã¨ã™ã‚‹å ´åˆã€‚ |
| **Azure CLI / VS Code Signedâ€‘in Identity** | `DefaultAzureCredential` ã‚’ä½¿ç”¨ã—ã€Azure CLI ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ Key Vault ã‚’å–å¾—                | å®Ÿéš›ã® Key Vault ã§å‹•ä½œæ¤œè¨¼ã—ãŸã„å ´åˆã€‚    |

> CI ç’°å¢ƒã§ã¯ GitHub Secrets ã«è¨­å®šã—ã€`azure/login` ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã® Managed Identity ã§ Key Vault ã¸ã‚¢ã‚¯ã‚»ã‚¹ã€‚

## ğŸ“¦ Blob Storage ã«ã¤ã„ã¦

* **Azurite** ãŒ Blob Storage ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦æ—¢ã«ã‚³ãƒ³ãƒ†ãƒŠã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
* é–‹ç™ºç”¨æ¥ç¶šæ–‡å­—åˆ—ã¯ `UseDevelopmentStorage=true` ã¾ãŸã¯ `DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=...` ã‚’åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚

---
